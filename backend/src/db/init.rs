use log::debug;
use sqlx::{Pool, Sqlite};

use crate::db::electricity_readings::create_electricity_reading_raw_init;
use crate::types::CEResult;

/*
sqlx database create
sqlx migrate run
// cargo sqlx prepare
*/
pub async fn initialise_database(pool: &Pool<Sqlite>) -> CEResult<()> {
    debug!("initialise_database() called");
    run_pending_migrations(pool).await?;
    // add_dummy_data(pool).await?; // TODO: DEV ONLY
    Ok(())
}

async fn run_pending_migrations(pool: &Pool<Sqlite>) -> CEResult<()> {
    debug!("run_pending_migrations() called");
    sqlx::migrate!("./migrations").run(pool).await?;
    Ok(())
}

const ALICE: (&str, &str, &str) = ("alice_auth_id", "Alice", "alice@alice.com");
const BOB: (&str, &str, &str) = ("bob_auth_id", "Bob", "bob@bob.com");
const CHARLIE: (&str, &str, &str) = ("charlie_auth_id", "Charlie", "charlie@charlie.com");
const DAVID: (&str, &str, &str) = ("david_auth_id", "David", "david@david.com");

#[allow(dead_code)]
#[allow(clippy::unreadable_literal)]
#[allow(clippy::too_many_lines)]
async fn add_dummy_data(pool: &Pool<Sqlite>) -> CEResult<()> {
    debug!("add_dummy_data() called");
    create_electricity_reading_raw_init(
        pool,
        43518.2,
        68008.3,
        1641000383420,
        String::from(BOB.0),
        String::from(BOB.1),
        String::from(BOB.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        43569.3,
        68278.8,
        1641613072610,
        String::from(BOB.0),
        String::from(BOB.1),
        String::from(BOB.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        43465.0,
        68578.7,
        1643129641115,
        String::from(DAVID.0),
        String::from(DAVID.1),
        String::from(DAVID.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        43642.0,
        68607.6,
        1643272674020,
        String::from(DAVID.0),
        String::from(DAVID.1),
        String::from(DAVID.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        43866.8,
        69357.0,
        1645552039937,
        String::from(DAVID.0),
        String::from(DAVID.1),
        String::from(DAVID.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        43800.4,
        69128.1,
        1645232612324,
        String::from(CHARLIE.0),
        String::from(CHARLIE.1),
        String::from(CHARLIE.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        43872.6,
        69631.0,
        1646723225305,
        String::from(DAVID.0),
        String::from(DAVID.1),
        String::from(DAVID.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        43966.4,
        69722.0,
        1647230029042,
        String::from(DAVID.0),
        String::from(DAVID.1),
        String::from(DAVID.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        44004.0,
        70053.6,
        1647917739878,
        String::from(ALICE.0),
        String::from(ALICE.1),
        String::from(ALICE.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        44138.1,
        70371.3,
        1648670845999,
        String::from(DAVID.0),
        String::from(DAVID.1),
        String::from(DAVID.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        44226.4,
        70519.0,
        1649555336563,
        String::from(DAVID.0),
        String::from(DAVID.1),
        String::from(DAVID.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        44111.4,
        71024.3,
        1651140763696,
        String::from(ALICE.0),
        String::from(ALICE.1),
        String::from(ALICE.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        44319.5,
        71353.9,
        1651727360317,
        String::from(CHARLIE.0),
        String::from(CHARLIE.1),
        String::from(CHARLIE.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        44477.6,
        71496.6,
        1652834877746,
        String::from(BOB.0),
        String::from(BOB.1),
        String::from(BOB.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        44395.4,
        71778.7,
        1653484748384,
        String::from(ALICE.0),
        String::from(ALICE.1),
        String::from(ALICE.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        44376.1,
        71536.8,
        1653451394170,
        String::from(ALICE.0),
        String::from(ALICE.1),
        String::from(ALICE.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        44608.2,
        72130.3,
        1655084401446,
        String::from(ALICE.0),
        String::from(ALICE.1),
        String::from(ALICE.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        44590.3,
        72692.9,
        1656671199136,
        String::from(ALICE.0),
        String::from(ALICE.1),
        String::from(ALICE.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        44692.1,
        72461.3,
        1656533898031,
        String::from(ALICE.0),
        String::from(ALICE.1),
        String::from(ALICE.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        44560.3,
        72811.3,
        1658329750575,
        String::from(BOB.0),
        String::from(BOB.1),
        String::from(BOB.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        44850.1,
        73038.1,
        1658341703844,
        String::from(DAVID.0),
        String::from(DAVID.1),
        String::from(DAVID.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        44803.4,
        73061.6,
        1659052954662,
        String::from(CHARLIE.0),
        String::from(CHARLIE.1),
        String::from(CHARLIE.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        44908.8,
        73381.9,
        1659910160523,
        String::from(CHARLIE.0),
        String::from(CHARLIE.1),
        String::from(CHARLIE.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        45100.0,
        73862.5,
        1661026701187,
        String::from(DAVID.0),
        String::from(DAVID.1),
        String::from(DAVID.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        44887.9,
        73978.0,
        1661398465217,
        String::from(BOB.0),
        String::from(BOB.1),
        String::from(BOB.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        45056.5,
        74530.1,
        1663754182584,
        String::from(BOB.0),
        String::from(BOB.1),
        String::from(BOB.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        45216.3,
        74617.9,
        1664075822971,
        String::from(BOB.0),
        String::from(BOB.1),
        String::from(BOB.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        45319.0,
        74937.1,
        1664734555408,
        String::from(BOB.0),
        String::from(BOB.1),
        String::from(BOB.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        45092.0,
        75254.1,
        1666030078248,
        String::from(ALICE.0),
        String::from(ALICE.1),
        String::from(ALICE.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        45148.5,
        75211.3,
        1666533749259,
        String::from(CHARLIE.0),
        String::from(CHARLIE.1),
        String::from(CHARLIE.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        45386.6,
        75655.2,
        1668181165448,
        String::from(BOB.0),
        String::from(BOB.1),
        String::from(BOB.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        45342.6,
        75713.9,
        1667868287956,
        String::from(ALICE.0),
        String::from(ALICE.1),
        String::from(ALICE.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        45471.7,
        76135.9,
        1668816977879,
        String::from(BOB.0),
        String::from(BOB.1),
        String::from(BOB.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        45491.1,
        76351.4,
        1670100810589,
        String::from(ALICE.0),
        String::from(ALICE.1),
        String::from(ALICE.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        45714.4,
        76775.9,
        1671550525785,
        String::from(DAVID.0),
        String::from(DAVID.1),
        String::from(DAVID.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        45763.0,
        76836.2,
        1671720937888,
        String::from(CHARLIE.0),
        String::from(CHARLIE.1),
        String::from(CHARLIE.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        45760.2,
        77176.0,
        1673004938684,
        String::from(ALICE.0),
        String::from(ALICE.1),
        String::from(ALICE.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        45587.8,
        77393.9,
        1673280099937,
        String::from(ALICE.0),
        String::from(ALICE.1),
        String::from(ALICE.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        45917.4,
        77682.1,
        1674874285158,
        String::from(BOB.0),
        String::from(BOB.1),
        String::from(BOB.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        45868.2,
        77765.8,
        1674799862469,
        String::from(CHARLIE.0),
        String::from(CHARLIE.1),
        String::from(CHARLIE.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        45979.8,
        78297.5,
        1676811200620,
        String::from(DAVID.0),
        String::from(DAVID.1),
        String::from(DAVID.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        46078.4,
        78599.7,
        1677161016562,
        String::from(CHARLIE.0),
        String::from(CHARLIE.1),
        String::from(CHARLIE.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        46005.9,
        78595.5,
        1677962471680,
        String::from(ALICE.0),
        String::from(ALICE.1),
        String::from(ALICE.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        46180.3,
        79114.0,
        1679029057653,
        String::from(CHARLIE.0),
        String::from(CHARLIE.1),
        String::from(CHARLIE.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        46190.9,
        79232.8,
        1679741055745,
        String::from(DAVID.0),
        String::from(DAVID.1),
        String::from(DAVID.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        46234.2,
        79566.7,
        1680704416455,
        String::from(CHARLIE.0),
        String::from(CHARLIE.1),
        String::from(CHARLIE.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        46236.2,
        79753.5,
        1681555555372,
        String::from(CHARLIE.0),
        String::from(CHARLIE.1),
        String::from(CHARLIE.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        46405.7,
        79990.3,
        1682651802853,
        String::from(DAVID.0),
        String::from(DAVID.1),
        String::from(DAVID.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        46407.4,
        80321.1,
        1683525557483,
        String::from(CHARLIE.0),
        String::from(CHARLIE.1),
        String::from(CHARLIE.2),
    )
    .await?;
    create_electricity_reading_raw_init(
        pool,
        46593.5,
        80365.7,
        1684268553274,
        String::from(BOB.0),
        String::from(BOB.1),
        String::from(BOB.2),
    )
    .await?;
    Ok(())
}
